/*
 * jQuery Double Tap Plugin.
 * 
 * Copyright (c) 2010 Raul Sanchez (http://www.sanraul.com)
 * 
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 */
(function(c){var b=/android|iphone|ipad/i.test(navigator.userAgent.toLowerCase()),a=b?"touchend":"click";c.fn.doubletap=function(e,d){d=(d==null)?300:d;this.bind("touchstart",function(f){c(this).data("touchStarted",new Date().getTime())});this.bind(a,function(h){var f=new Date().getTime();var i=b&&c(this).data("touchStarted");if(!b||(i&&(f-i<d))){c(this).data("touchStarted",null);var g=c(this).data("lastTouch")||f+1;var j=f-g;if(j<d&&0<j){c(this).data("lastTouch",null);if(e!==null&&typeof e==="function"){e(h)}}else{c(this).data("lastTouch",f)}}})}})(jQuery);jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});(function(f,e,b,h){jQuery.widget("mobile.scrollview",jQuery.mobile.widget,{options:{fps:60,direction:null,scrollDuration:2000,overshootDuration:250,snapbackDuration:500,moveThreshold:10,moveIntervalThreshold:150,scrollMethod:"translate",startEventName:"scrollstart",updateEventName:"scrollupdate",stopEventName:"scrollstop",showScrollBars:true,pagingEnabled:false,delayedClickSelector:"a,input,textarea,select,button,.ui-btn",delayedClickEnabled:false,rotate:0},_makePositioned:function(i){if(i.css("position")=="static"){i.css("position","relative")}},_create:function(){this._$clip=f(this.element).addClass("ui-scrollview-clip");var j=this._$clip.children();if(j.length>1){j=this._$clip.wrapInner("<div></div>").children()}this._$view=j.addClass("ui-scrollview-view");this._$clip.css("overflow",this.options.scrollMethod==="scroll"?"scroll":"hidden");this._makePositioned(this._$clip);this._$view.css("overflow","hidden");this.options.showScrollBars=this.options.scrollMethod==="scroll"?false:this.options.showScrollBars;this._makePositioned(this._$view);this._$view.css({left:0,top:0});this._sx=0;this._sy=0;var k=this.options.direction;this._hTracker=(k!=="y")?new g(this.options):null;this._vTracker=(k!=="x")?new g(this.options):null;this._timerInterval=1000/this.options.fps;this._timerID=0;var i=this;this._timerCB=function(){i._handleMomentumScroll()};this._addBehaviors()},_startMScroll:function(l,k){this._stopMScroll();this._showScrollBars();var n=false;var m=this.options.scrollDuration;this._$clip.trigger(this.options.startEventName);var j=this._hTracker;if(j){var p=this._$clip.width();var i=this._$view.width();j.start(this._sx,l,m,(i>p)?-(i-p):0,0);n=!j.done()}var o=this._vTracker;if(o){var p=this._$clip.height();var i=this._$view.height();o.start(this._sy,k,m,(i>p)?-(i-p):0,0);n=n||!o.done()}if(n){this._timerID=setTimeout(this._timerCB,this._timerInterval)}else{this._stopMScroll()}},_stopMScroll:function(){if(this._timerID){this._$clip.trigger(this.options.stopEventName);clearTimeout(this._timerID)}this._timerID=0;if(this._vTracker){this._vTracker.reset()}if(this._hTracker){this._hTracker.reset()}this._hideScrollBars()},_handleMomentumScroll:function(){var l=false;var j=this._$view;var i=0,n=0;var m=this._vTracker;if(m){m.update();n=m.getPosition();l=!m.done()}var k=this._hTracker;if(k){k.update();i=k.getPosition();l=l||!k.done()}this._setScrollPosition(i,n);this._$clip.trigger(this.options.updateEventName,[{x:i,y:n}]);if(l){this._timerID=setTimeout(this._timerCB,this._timerInterval)}else{this._stopMScroll()}},_setScrollPosition:function(i,p){this._sx=i;this._sy=p;var m=this._$view;var o=this.options.scrollMethod;switch(o){case"translate":c(m,i+"px",p+"px");break;case"position":m.css({left:i+"px",top:p+"px"});break;case"scroll":var n=this._$clip[0];n.scrollLeft=-i;n.scrollTop=-p;break}var j=this._$vScrollBar;var k=this._$hScrollBar;if(j){var l=j.find(".ui-scrollbar-thumb");if(o==="translate"){c(l,"0px",-p/m.height()*l.parent().height()+"px")}else{l.css("top",-p/m.height()*100+"%")}}if(k){var l=k.find(".ui-scrollbar-thumb");if(o==="translate"){c(l,-i/m.width()*l.parent().width()+"px","0px")}else{l.css("left",-i/m.width()*100+"%")}}},scrollTo:function(p,m,k){this._stopMScroll();if(!k){return this._setScrollPosition(p,m)}p=-p;m=-m;var r=this;var i=d();var l=f.easing["easeOutQuad"];var o=this._sx;var n=this._sy;var s=p-o;var q=m-n;var j=function(){var t=d()-i;if(t>=k){r._timerID=0;r._setScrollPosition(p,m)}else{var u=l(t/k,t,0,1,k);r._setScrollPosition(o+(s*u),n+(q*u));r._timerID=setTimeout(j,r._timerInterval)}};this._timerID=setTimeout(j,this._timerInterval)},getScrollPosition:function(){return{x:-this._sx,y:-this._sy}},_getScrollHierarchy:function(){var i=[];this._$clip.parents(".ui-scrollview-clip").each(function(){var j=f(this).jqmData("scrollview");if(j){i.unshift(j)}});return i},_getAncestorByDirection:function(k){var j=this._getScrollHierarchy();var m=j.length;while(0<m--){var i=j[m];var l=i.options.direction;if(!l||l==k){return i}}return null},_handleDragStart:function(m,o,n){f.each(this._getScrollHierarchy(),function(t,s){s._stopMScroll()});this._stopMScroll();var p=this._$clip;var r=this._$view;if(this.options.delayedClickEnabled){this._$clickEle=f(m.target).closest(this.options.delayedClickSelector)}this._lastX=o;this._lastY=n;this._doSnapBackX=false;this._doSnapBackY=false;this._speedX=0;this._speedY=0;this._directionLock="";this._didDrag=false;if(this._hTracker){var j=parseInt(p.css("width"),10);var q=parseInt(r.css("width"),10);this._maxX=j-q;if(this._maxX>0){this._maxX=0}if(this._$hScrollBar){this._$hScrollBar.find(".ui-scrollbar-thumb").css("width",(j>=q?"100%":Math.floor(j/q*100)+"%"))}}if(this._vTracker){var i=parseInt(p.css("height"),10);var k=parseInt(r.css("height"),10);this._maxY=i-k;if(this._maxY>0){this._maxY=0}if(this._$vScrollBar){this._$vScrollBar.find(".ui-scrollbar-thumb").css("height",(i>=k?"100%":Math.floor(i/k*100)+"%"))}}var l=this.options.direction;this._pageDelta=0;this._pageSize=0;this._pagePos=0;if(this.options.pagingEnabled&&(l==="x"||l==="y")){this._pageSize=l==="x"?j:i;this._pagePos=l==="x"?this._sx:this._sy;this._pagePos-=this._pagePos%this._pageSize}this._lastMove=0;this._enableTracking();if(!/touch/.test(m.type)||this.options.delayedClickEnabled){m.preventDefault()}m.stopPropagation()},_propagateDragMove:function(i,m,l,k,j){this._hideScrollBars();this._disableTracking();i._handleDragStart(m,l,k);i._directionLock=j;i._didDrag=this._didDrag},_handleDragMove:function(C,B,z){this._lastMove=d();var p=this._$view;var o=B-this._lastX;var n=z-this._lastY;var k=this.options.direction;var q=this.options.rotate/90;switch(q){case 1:case -1:var j=n;n=-1*o*q;o=j*q;break;case 2:n*=-1;break}if(!this._directionLock){var m=Math.abs(o);var l=Math.abs(n);var w=this.options.moveThreshold;if(m<w&&l<w){return false}var u=null;var s=0;if(m<l&&(m/l)<0.5){u="y"}else{if(m>l&&(l/m)<0.5){u="x"}}if(k&&u&&k!=u){var t=this._getAncestorByDirection(u);if(t){this._propagateDragMove(t,C,B,z,u);return false}}this._directionLock=k?k:(u?u:"none")}var E=this._sx;var D=this._sy;if(this._directionLock!=="y"&&this._hTracker){var m=this._sx;this._speedX=o;E=m+o;this._doSnapBackX=false;if(E>0||E<this._maxX){if(this._directionLock==="x"){var t=this._getAncestorByDirection("x");if(t){this._setScrollPosition(E>0?0:this._maxX,D);this._propagateDragMove(t,C,B,z,u);return false}}E=m+(o/2);this._doSnapBackX=true}}if(this._directionLock!=="x"&&this._vTracker){var l=this._sy;this._speedY=n;D=l+n;this._doSnapBackY=false;if(D>0||D<this._maxY){if(this._directionLock==="y"){var t=this._getAncestorByDirection("y");if(t){this._setScrollPosition(E,D>0?0:this._maxY);this._propagateDragMove(t,C,B,z,u);return false}}D=l+(n/2);this._doSnapBackY=true}}if(this.options.pagingEnabled&&(k==="x"||k==="y")){if(this._doSnapBackX||this._doSnapBackY){this._pageDelta=0}else{var A=this._pagePos;var i=k==="x"?E:D;var F=k==="x"?o:n;this._pageDelta=(A>i&&F<0)?this._pageSize:((A<i&&F>0)?-this._pageSize:0)}}this._didDrag=true;this._lastX=B;this._lastY=z;this._setScrollPosition(E,D);this._showScrollBars();return false},_handleDragStop:function(m){var i=this._lastMove;var r=d();var j=i&&(r-i)<=this.options.moveIntervalThreshold;var p=(this._hTracker&&this._speedX&&j)?this._speedX:(this._doSnapBackX?1:0);var o=(this._vTracker&&this._speedY&&j)?this._speedY:(this._doSnapBackY?1:0);var k=this.options.direction;if(this.options.pagingEnabled&&(k==="x"||k==="y")&&!this._doSnapBackX&&!this._doSnapBackY){var q=this._sx;var n=this._sy;if(k==="x"){q=-this._pagePos+this._pageDelta}else{n=-this._pagePos+this._pageDelta}this.scrollTo(q,n,this.options.snapbackDuration)}else{if(p||o){this._startMScroll(p,o)}else{this._hideScrollBars()}}this._disableTracking();if(!this._didDrag&&this.options.delayedClickEnabled&&this._$clickEle.length){this._$clickEle.trigger("mousedown").trigger("mouseup").trigger("click")}return this._didDrag?false:h},_enableTracking:function(){f(b).bind("touchmove",this._dragMoveCB);f(b).bind("mousemove",this._dragMoveCB);f(b).bind("touchend",this._dragStopCB);f(b).bind("mouseup",this._dragStopCB)},_disableTracking:function(){f(b).unbind("touchmove",this._dragMoveCB);f(b).unbind("mousemove",this._dragMoveCB);f(b).unbind("touchend",this._dragStopCB);f(b).unbind("mouseup",this._dragStopCB)},_showScrollBars:function(){var i="ui-scrollbar-visible";if(this._$vScrollBar){this._$vScrollBar.addClass(i)}if(this._$hScrollBar){this._$hScrollBar.addClass(i)}},_hideScrollBars:function(){var i="ui-scrollbar-visible";if(this._$vScrollBar){this._$vScrollBar.removeClass(i)}if(this._$hScrollBar){this._$hScrollBar.removeClass(i)}},_addBehaviors:function(){var i=this;this._dragStartCB=function(m){var n=/touch/.test(m.type)?m.originalEvent.touches[0]:m;return i._handleDragStart(m,n.clientX,n.clientY)};this._dragMoveCB=function(m){var n=/touch/.test(m.type)?m.originalEvent.touches[0]:m;return i._handleDragMove(m,n.clientX,n.clientY)};this._dragStopCB=function(m){return i._handleDragStop(m)};this._$view.bind("mousedown",this._dragStartCB);this._$view.bind("touchstart",this._dragStartCB);if(this.options.showScrollBars){var j=this._$clip;var k='<div class="ui-scrollbar ui-scrollbar-';var l='"><div class="ui-scrollbar-track"><div class="ui-scrollbar-thumb"></div></div></div>';if(this._vTracker){j.append(k+"y"+l);this._$vScrollBar=j.children(".ui-scrollbar-y")}if(this._hTracker){j.append(k+"x"+l);this._$hScrollBar=j.children(".ui-scrollbar-x")}}}});function c(k,i,l){var j="translate3d("+i+","+l+", 0px)";k.css({"-moz-transform":j,"-webkit-transform":j,"transform":j})}function g(i){this.options=f.extend({},i);this.easing="easeOutQuad";this.reset()}var a={scrolling:0,overshot:1,snapback:2,done:3};function d(){return(new Date()).getTime()}f.extend(g.prototype,{start:function(m,k,l,j,i){this.state=(k!=0)?((m<j||m>i)?a.snapback:a.scrolling):a.done;this.pos=m;this.speed=k;this.duration=(this.state==a.snapback)?this.options.snapbackDuration:l;this.minPos=j;this.maxPos=i;this.fromPos=(this.state==a.snapback)?this.pos:0;this.toPos=(this.state==a.snapback)?((this.pos<this.minPos)?this.minPos:this.maxPos):0;this.startTime=d()},reset:function(){this.state=a.done;this.pos=0;this.speed=0;this.minPos=0;this.maxPos=0;this.duration=0},update:function(){var m=this.state;if(m==a.done){return this.pos}var n=this.duration;var j=d()-this.startTime;j=j>n?n:j;if(m==a.scrolling||m==a.overshot){var k=this.speed*(1-f.easing[this.easing](j/n,j,0,1,n));var i=this.pos+k;var l=(m==a.scrolling)&&(i<this.minPos||i>this.maxPos);if(l){i=(i<this.minPos)?this.minPos:this.maxPos}this.pos=i;if(m==a.overshot){if(j>=n){this.state=a.snapback;this.fromPos=this.pos;this.toPos=(i<this.minPos)?this.minPos:this.maxPos;this.duration=this.options.snapbackDuration;this.startTime=d();j=0}}else{if(m==a.scrolling){if(l){this.state=a.overshot;this.speed=k/2;this.duration=this.options.overshootDuration;this.startTime=d()}else{if(j>=n){this.state=a.done}}}}}else{if(m==a.snapback){if(j>=n){this.pos=this.toPos;this.state=a.done}else{this.pos=this.fromPos+((this.toPos-this.fromPos)*f.easing[this.easing](j/n,j,0,1,n))}}}return this.pos},done:function(){return this.state==a.done},getPosition:function(){return this.pos}});jQuery.widget("mobile.scrolllistview",jQuery.mobile.scrollview,{options:{direction:"y"},_create:function(){f.mobile.scrollview.prototype._create.call(this);this._$dividers=this._$view.find(":jqmData(role='list-divider')");this._lastDivider=null},_setScrollPosition:function(s,r){f.mobile.scrollview.prototype._setScrollPosition.call(this,s,r);r=-r;var o=this._$dividers;var k=o.length;var p=null;var v=0;var l=null;for(var m=0;m<k;m++){l=o.get(m);var u=l.offsetTop;if(r>=u){p=l;v=u}else{if(p){break}}}if(p){var n=p.offsetHeight;var q=(p!=l)?l.offsetTop:(this._$view.get(0).offsetHeight);if(r+n>=q){r=(q-n)-v}else{r=r-v}var j=this._lastDivider;if(j&&p!=j){c(f(j),0,0)}c(f(p),0,r+"px");this._lastDivider=p}}})})(jQuery,window,document);var scrollview={isScrolling:false,isSwiping:false,isDoubleTapping:false,isTapHolding:false,setup:function(a){$.mobile.scrollview.prototype._handleDragStart=(function(d){var c=$.mobile.scrollview.prototype._handleDragStart;return function b(g){var h=$.inArray($(g.target).closest(".pageWidget").attr("id"),a.linkOrigin);if(h==-1){h=$.inArray($(g.target).closest(".pageWidget").data("lockto"),a.linkOrigin)}var f=h>-1&&a.triggerType[h];if(f&&(f=="taphold"||f=="doubletap"||f.substr(0,5)=="swipe")){return true}c.apply(this,arguments)}}());$.mobile.scrollview.prototype._handleDragMove=(function(d){var c=$.mobile.scrollview.prototype._handleDragMove;return function b(f){scrollview.isScrolling=true;c.apply(this,arguments)}}());$.mobile.scrollview.prototype._handleDragStop=(function(c){var b=$.mobile.scrollview.prototype._handleDragStop;return function d(f){setTimeout(function(){scrollview.isScrolling=false},10);b.apply(this,arguments)}}())},showPage:function(h){var g=$(this);g.find(".ui-content").attr("data-"+$.mobile.ns+"scroll","y");var f=storage.get(g_preview).pageWH;var i,b=$(g).attr("id");if(b=="home"){return}i=[storage.get(b).width,storage.get(b).height];if(f[0]>=i[0]&&f[1]>=i[1]){return}var j=storage.get(g_preview).orientation;var c=storage.get(b).orientation;var d=j==c;var a="xy";if(!d){i=[i[1],i[0]]}if(i[0]==f[0]){a=d?"y":"x"}if(i[1]==f[1]){a=d?"x":"y"}g.find(":jqmData(scroll):not(.ui-scrollview-clip)").each(function(){var m=$(this);var n=m.attr("id");if(m.hasClass("ui-scrolllistview")){m.scrolllistview();return true}var k=m.jqmData("scroll")+"";var k=m.jqmData("scroll")+"";var e=k&&k.search(/^[xy]p$/)!=-1;var l={direction:a||undefined,paging:e||undefined,scrollMethod:m.jqmData("scroll-method")||undefined};m.scrollview(l)});if(!d){f=[f[1],f[0]]}g.css({"min-height":preview.getTrueHeight()+"px"}).children(".ui-content").css({"width":f[0]+"px","height":f[1]+"px"})}};