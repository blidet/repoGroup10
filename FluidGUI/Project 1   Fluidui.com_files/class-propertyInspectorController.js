var propInspectorCtrl={textPropMap:{textBold:{property:"font-weight",active:"bold",inactive:"normal",importAction:"checkbox",command:{name:"setFont",property:"weight"}},textItalics:{property:"font-style",active:"italic",inactive:"normal",importAction:"checkbox",command:{name:"setFont",property:"style"}},textUnderline:{property:"text-decoration",active:"underline",inactive:"none",importAction:"checkbox",command:{name:"setTextProperty",property:"decoration"}},textLeft:{property:"text-align",active:"left",importAction:"checkbox",command:{name:"setTextProperty",property:"align"}},textCenter:{property:"text-align",active:"center",importAction:"checkbox",command:{name:"setTextProperty",property:"align"}},textRight:{property:"text-align",active:"right",importAction:"checkbox",command:{name:"setTextProperty",property:"align"}},textColor:{property:"color",importAction:"textColor",command:{name:"setColor",property:"color"}},textSize:{property:"font-size",importAction:"select",command:{name:"setFont",property:"size"}},textFont:{property:"font-family",importAction:"select",command:{name:"setFont",property:"family"}},textOpacitySlider:{property:"opacity",importAction:"slider",command:{name:"setColor",property:"opacity"}},textOpacityArea:{property:"opacity",importAction:"slider",command:{name:"setColor",property:"opacity"}},textVerticalCenter:{property:"top",active:"0.5%",importAction:"checkbox",command:{name:"setTextProperty",property:"alignVertical"}},textVerticalBottom:{property:"top",active:"1%",importAction:"checkbox",command:{name:"setTextProperty",property:"alignVertical"}},textVerticalTop:{property:"top",active:"0%",importAction:"checkbox",command:{name:"setTextProperty",property:"alignVertical"}}},shapePropMap:{shapeBackground:{controlCssProp:"background-color",property:"bgc",index:0,command:{name:"setBackgroundColor",property:"color"}},shapeBorder:{property:"b",controlCssProp:"background-color",index:1,command:{name:"setBorder",property:"color"}},shapeBorderStyle:{property:"border-style"},shapeBorderWidth:{property:"b",index:0,command:{name:"setBorder",property:"width"}},shapeBorderRadius:{property:"b",index:2,command:{name:"setBorder",property:"radius"}},shapeOpacitySlider:{property:"bgc",command:{name:"setColor",property:"opacity"}},shapeOpacityArea:{property:"bgc",command:{name:"setColor",property:"opacity"}},shapeHeight:{cssProperty:"height",property:"tlwh",index:3,command:{name:"resize",property:"height"}},shapeWidth:{cssProperty:"width",property:"tlwh",index:2,command:{name:"resize",property:"width"}}},currentSelection:false,textWidgets:false,shapeWidgets:false,uploadWidgets:false,saveSelection:function(){var b=document.querySelectorAll("#canvasPages .ui-selected");var a=[];fluid.util._.forEach(b,function(e){var g=e.id;a.push(e);var f=widget.getSubTextElements(e);a=a.concat(fluid.util._.toArray(f));var c=widget.get(g);if(c.seg){var d=document.querySelectorAll('[data-lockto="'+g+'"]');a=a.concat(fluid.util._.toArray(d))}});a=$(a);propInspectorCtrl.currentSelection=a;propInspectorCtrl.textWidgets=propInspectorCtrl.getTextWidgets(a);propInspectorCtrl.shapeWidgets=propInspectorCtrl.getShapeWidgets(a);propInspectorCtrl.uploadWidgets=propInspectorCtrl.getUploads(a)},filterTextOrShape:function(){var b=propInspectorCtrl.currentSelection;var k=b.length;var i=$([]);var d=$([]);var j=$([]);var e=$([]);var a=$([]);function c(){var m=$(this);var n=m.attr("id");var l=widget.get(n);if(l.tc){j=j.add(m)}if(!l.tc&&!l.upload){d=d.add(m)}if(l.b){e=e.add(m)}if(l.upload&&l.upload=="y"){i=i.add(m)}if(!l.bgc&&!l.r){a=a.add(m)}}b.each(c);if(b.length<1){var h=false}else{if(j.length>0&&d.length>0){var g=(e.length>0)?"showBorder":"showBackground";var f={showDefaults:["showShapeInspector","showTextInspector"],showColorPicker:["showBackground",g,"showTextColor"]}}else{if(i.length==k){var f={showDefaults:["showShapeInspector"],showColorPicker:false}}else{if(a.length==k){var f={showDefaults:["hideInspectors"],showColorPicker:false}}else{if(j.length>0&&d.length==0){var f={showDefaults:["showTextInspector"],showColorPicker:["showTextColor"]}}else{if(j.length==0&&d.length>0){var g=(e.length>0)?"showBorder":"showBackground";var f={showDefaults:["showShapeInspector"],showColorPicker:["showBackground",g]}}}}}}}return f},updateBackgroundBorderInfo:function(d){var j=colorPicker.getWidgetForCP();var e="transparent";var b=propInspector.defaultColor;var a=0;var l=["b","bs","bts","bls","bms","bbs","brs"];for(var f=0;f<l.length;f++){var h=j[l[f]];try{if(h.length>0){e=utils.replaceRgbaAlpha(h[1],1);a=h[0];b=(a==0)?propInspector.defaultColor:"background:none;"}}catch(g){}}var k="transparent";var c=propInspector.defaultColor;if(j.bgc){var i=$.extend(true,[],j.bgc);i=i.toString();if(i){if(i!=="rgba(0,0,0,0.0),rgba(0,0,0,0.0)"){k=utils.replaceRgbaAlpha(j.bgc[0],1);c="background:none;"}}}$("#shapeBackground").css("background-color",k);$("#noBackground").attr("style",c);$("#shapeBorder").css("background-color",e);$("#noBorder").attr("style",b);if(d){return}else{(a>0)?propInspector.borderContainers.css({"pointer-events":"auto","opacity":1}):propInspector.borderContainers.css({"pointer-events":"none","opacity":0.5})}},updateShapeProps:function(){function d(){var w=(propInspectorCtrl.shapeWidgets.length>0)?propInspectorCtrl.shapeWidgets.last():propInspectorCtrl.uploadWidgets.last();if($(w).attr("data-segment")){var v=$(w).attr("data-lockto");var x=$("#"+v);if(x.hasClass("ui-selected")&&!$(w).hasClass("ui-selected")){var w=x}}return w}function b(){propInspector.heightProps.css({"pointer-events":"auto","opacity":1});propInspector.widthProps.css({"pointer-events":"auto","opacity":1})}function i(){var z=$(this);var B=z.attr("id");var v=widget.get(B);m=$.extend(true,{},v);if(z.hasClass("backgroundWidget")){s=s.add(z)}if(v.b||v.bbs||v.bts||v.bms||v.bls||v.brs||v.bs){var y=["b","bs","bts","bls","bms","bbs","brs"];for(var x=0;x<y.length;x++){var A=v[y[x]];try{if(A.length>0){f=f.add(z);$.extend(true,a,A)}}catch(w){}}}if(v.bgc){q=$.extend(true,{},v)}if(v.upload||v.upload=="y"||v.type=="image/png"){n=n.add(z)}if(z.hasClass("rootWidget")){r=r.add(z)}if(v.segment){o=o.add(z)}if(v.seg){j=j.add(z)}if(v.r=="h"){k=k.add(z)}if(v.r=="v"){c=c.add(z)}if(v.s){if(v.s=="c"||v.s=="arcU"||v.s=="arcD"||v.s=="arcL"||v.s=="arcR"){e.push(B)}}}function h(){if(a.length>0){var w=a[2];t=a[0]}else{var w=0;t=0}var v=(q)?q.bgc[0]:"rgba(0,0,0,0.0)";var x=parseInt(utils.getRgbaAlpha(v)*100);var y=d();width=parseFloat($(y).css("width"))||0;height=parseFloat($(y).css("height"))||0;$("#shapeBorderWidth").val(t);$("#shapeBorderRadius").val(w);$("#shapeOpacityInput").text(x+" %");propInspectorCtrl.convertShapeOpacityToSlider(x);$("#shapeWidth").val(width);$("#shapeHeight").val(height)}function g(v,w){if(f.length<1){propInspector.borderContainers.css({"pointer-events":"none","opacity":0.5})}else{(w.length==l)?propInspector.widgetBorderRadius.css({"pointer-events":"none","opacity":0.5}):propInspector.widgetBorderRadius.css({"pointer-events":"auto","opacity":1});(v==0)?propInspector.borderContainers.css({"pointer-events":"none","opacity":0.5}):propInspector.borderContainers.css({"pointer-events":"auto","opacity":1})}if(s.length==l){propInspector.shapeSizeProperties.hide();propInspector.shapeBorderControl.hide()}if(n.length==l){propInspector.shapeBorderControl.hide();propInspector.backgroundContainers.hide();propInspector.borderContainers.hide();propInspector.backgroundBorderHolder.hide();propInspector.shapeOpacityControl.hide()}if(l>1){propInspector.shapeSizeProperties.hide()}if(k.length==l){propInspector.heightProps.css({"pointer-events":"none","opacity":0.5})}if(c.length==l){propInspector.widthProps.css({"pointer-events":"none","opacity":0.5})}}var p=propInspectorCtrl.shapeWidgets;p=p.add(propInspectorCtrl.uploadWidgets);if(p.length==0){propInspector.shapeProps.hide();return}var s=$([]);var r=$([]);var j=$([]);var f=$([]);var o=$([]);var n=$([]);var k=$([]);var c=$([]);var u=$([]);var m;var q;var a=[];var t;var e=[];b();p.each(i);var l=propInspectorCtrl.getWidgetAmount(r,j,o);h();g(t,e)},getWidgetAmount:function(b,f,d){var e=d.length;var a=f.length;var c=b.length;var g=0;if(e>0){d.each(function(){var k=$(this);var l=k.attr("id");if(a>0){var j=$(f).find(l);g+=1}})}var i=propInspectorCtrl.shapeWidgets.add(propInspectorCtrl.uploadWidgets);var h=i.length-g;return h},_getTextPropertyValue:function(a,d,b){var c;if(d.importAction){c=propInspectorCtrl.widgetTextPropGet(d,$("#"+b))}return c},_getShapePropertyValue:function(b,l,i,j,k){l=l||propInspectorCtrl.getPropMap("shape")[b];j=j||$("#"+b);var f=$("#"+i);var c;if(!k){k=widget.get(i);if(!k[l.property]&&k.segments&&k.segments.length){k=widget.get(k.segments[0].id)}}if(l.property!==undefined&&l.index!==undefined){var a=k[l.property];c=a&&a[l.index];if(typeof c==="string"&&j.attr("type")=="number"){var g=f.css(l.cssProperty);c=g?parseFloat(g):0}}else{if(b=="shapeOpacitySlider"||b=="shapeOpacityArea"){c=100;try{var d=k[l.property][0];c=parseInt(utils.getRgbaAlpha(d)*100)}catch(h){}}}return c},filterBackgroundTypes:function(){var c=propInspectorCtrl.shapeWidgets;var d=c.filter(".ui-selected").last().attr("id");var a=widget.get(d);if(a.bg=="c"||a.bg=="s"||!a.bg){var b="showFlatColor"}else{var b="showGradientGallery"}return b},getTextWidgets:function(b){var a=$([]);b.each(function(){var d=$(this);var e=d.attr("id");var c=widget.get(e);if(c.tc){a=a.add(d)}});return a},getShapeWidgets:function(c){var b=$([]);var a=$([]);c.each(function(){var e=$(this);var f=e.attr("id");var d=widget.get(f);if(!d.tc){if(!e.hasClass("ui-selected")&&!(d.seg||d.segment)){e=false}else{if(d.upload&&d.upload=="y"){e=false}else{if((e.attr("data-segment")!=e.attr("id"))&&!e.hasClass("ui-selected")){e=false}else{b=b.add(e)}}}}});return b},getUploads:function(b){var a=$([]);b.each(function(){var d=$(this);var e=d.attr("id");var c=widget.get(e);if(c.upload||c.upload=="y"){a=a.add(d)}});return a},updateTextProps:function(){var a=propInspectorCtrl.textWidgets;var c=propInspectorCtrl.textPropMap;if(a.length>0){var b=a.last();$("#propContainer").find(".radio, .checkbox").removeClass("activeCheckbox");for(property in c){if(c[property].importAction){propInspectorCtrl[c[property].importAction+"PropImport"](a,c,property,b)}}}else{return}},checkboxPropImport:function(h,c,i,d){var g=$("#"+i);var j=c[i];var f=propInspectorCtrl.widgetTextPropGet(j,d);if(j.property=="top"){var e=parseInt(d.css("height"));var a=parseInt(d.find(".widgetText").css("padding-top"));var b=(a/e);if(b>0){f="0%";if(b>0.3){f="0.5%";if(b>0.7){f="1%"}}}}if(f==j.active){g.addClass("activeCheckbox")}else{if(f==j.inactive){g.removeClass("activeCheckbox")}}},textColorPropImport:function(c,a,e,d){var f=a[e];var b=propInspectorCtrl.widgetTextPropGet(f,d);$("#textColor").css("background-color",b)},selectPropImport:function(c,a,f,e){var d=$("#"+f);var g=a[f];var b=propInspectorCtrl.widgetTextPropGet(g,e);if(b[0]=="'"){b=b.split("'")[1]}d.val(b)},sliderAreaWidth:false,sliderConstant:false,sliderTextField:false,sliderWidth:false,sliderPrevValue:0,initSliders:function(){var a=this;var c=$(a).attr("id");if(c=="textOpacitySlider"){propInspectorCtrl.sliderAreaWidth=parseInt($("#textOpacityArea").css("width"));propInspectorCtrl.sliderTextField=$("#textOpacityInput")}else{if(c=="shapeOpacitySlider"){propInspectorCtrl.sliderAreaWidth=parseInt($("#shapeOpacityArea").css("width"));propInspectorCtrl.sliderTextField=$("#shapeOpacityInput")}}var b=parseInt($(a).css("width"));propInspectorCtrl.sliderConstant=100/(propInspectorCtrl.sliderAreaWidth-b)},_sliderChanged:function(a,e,c){var d=a.attr("id");var b=parseInt((propInspectorCtrl.sliderConstant*e));propInspectorCtrl._exportProps(d,b/100,c)},sliderChanged:function(c,b){var f=$(this).attr("id");var d=parseInt((propInspectorCtrl.sliderConstant*b.position.left));var a=propInspectorCtrl.sliderTextField;a.text(d+" %")},sliderStopped:function(b,a){propInspectorCtrl._sliderChanged($(this),a.position.left,false);if(b.target.id=="shapeOpacitySlider"){propInspectorCtrl.updateBackgroundBorderInfo()}},sliderClicked:function(i){var n=$(this);var b=n.attr("id");if(i.target.id=="shapeOpacityInput"||i.target.id=="textOpacityInput"){return}var h=i.target.getClientRects()[0],f=i.clientX-h.left;if(b=="shapeOpacityArea"){var c=$("#shapeOpacitySlider");var d=parseInt(c.css("width"));var l="shapeOpacityInput"}else{if(b=="textOpacityArea"){var c=$("#textOpacitySlider");var d=parseInt(c.css("width"));var l="textOpacityInput"}}var g=parseInt(n.css("width"));var a=g-d;var k=g/100;var j=g/a;var m=parseInt(f/k);$("#"+l).text(m+" %");c.css("left",f/j);propInspectorCtrl._exportProps(b,m/100,false);if(b=="shapeOpacityArea"){propInspectorCtrl.updateBackgroundBorderInfo()}},sliderPropImport:function(c,a,e,d){var f=a[e];var b=parseFloat(propInspectorCtrl.widgetTextPropGet(f,d));if(b<=1){b=100}propInspectorCtrl.convertTextOpacityToSlider(b)},widgetTextPropGet:function(d,b){var c=propInspectorCtrl.widgetSelectText(b).css(d.property);if(c===undefined&&"inactive" in d){c=d.inactive}if(d.property=="font-size"){c=(c)?parseInt(c):10}var a=parseFloat(c);if((!isNaN(a))&&(a==parseFloat(d.active))){return d.active}return c},convertTextOpacityToSlider:function(d){var b=$("#textOpacitySlider");var c=$("#textOpacityInput");var f=parseInt($("#textOpacityArea").css("width"));var a=parseInt(b.css("width"));var e=100/(f-a);c.text(d+" %");b.css("left",d/e)},toggleCheckboxStyle:function(){$(this).toggleClass("activeCheckbox");var b=propInspectorCtrl.textPropMap;var a;if($(this).hasClass("activeCheckbox")){a=b[this.id].active}else{a=b[this.id].inactive}propInspectorCtrl._exportProps(this.id,a)},toggleRadioStyle:function(){var a=propInspectorCtrl.textPropMap;$(this).addClass("activeCheckbox").siblings(".radio").removeClass("activeCheckbox");propInspectorCtrl._exportProps(this.id,a[this.id].active)},togglehozontalAlignment:function(){var a=propInspectorCtrl.textPropMap;$(this).addClass("activeCheckbox").siblings(".hozontalAlignment").removeClass("activeCheckbox");propInspectorCtrl._exportProps(this.id,a[this.id].active)},convertShapeOpacityToSlider:function(d){var b=$("#shapeOpacitySlider");var c=$("#shapeOpacityInput");var f=parseInt($("#shapeOpacityArea").css("width"));var a=parseInt(b.css("width"));var e=100/(f-a);c.text(d+" %");b.css("left",d/e)},numFieldInput:false,keyToggle:false,changeShapeProps:function(c){if(c.keyCode>=37&&c.keyCode<=40){return false}var b=$(this);var a=b.val();var a=Math.abs(parseInt(a));if((isNaN(a))==true){b.val("");return false}propInspectorCtrl.numFieldInput=a;if(propInspectorCtrl.keyToggle=="on"){return false}propInspectorCtrl.keyToggle="on";propInspectorCtrl.launchInputTimer(b);return false},launchInputTimer:function(b){function a(){$(b).val(propInspectorCtrl.numFieldInput);var c=b;propInspectorCtrl.applyChangedField(c);propInspectorCtrl.keyToggle=false;propInspectorCtrl.numFieldInput=false}setTimeout(a,500)},filterNumberFieldInputs:function(a){if(a.hasClass("shapeBorderBtn")){var b=$("#shapeBorderWidth")}else{if(a.hasClass("shapeRadiusBtn")){var b=$("#shapeBorderRadius")}else{if(a.hasClass("shapeHeightBtn")){var b=$("#shapeHeight")}else{if(a.hasClass("shapeWidthBtn")){var b=$("#shapeWidth")}}}}return b},setClickTimeout:false,targetElement:false,changeNumberValue:function(b){var a=$(this);propInspectorCtrl.targetElement=propInspectorCtrl.filterNumberFieldInputs(a);propInspectorCtrl.setClickTimeout=setInterval(function(){var e=propInspectorCtrl.targetElement;var c=parseInt(e.val())||0;if(a.hasClass("increaseNumber")){var d=c+1}else{if(a.hasClass("reduceNumber")){var d=c-1}}var d=Math.abs(d);e.val(d)},60)},stopNumberValueInput:function(){if(propInspectorCtrl.setClickTimeout==false){return}clearInterval(propInspectorCtrl.setClickTimeout);propInspectorCtrl.setClickTimeout=false;var a=$(this);var b=propInspectorCtrl.filterNumberFieldInputs(a);propInspectorCtrl.applyChangedField(b)},applyChangedField:function(d){if(!$("#propContainer").is(":visible")){return}var e=d.attr("id");var a=d.val();if((isNaN(a))==true){return false}if(e=="shapeBorderRadius"||e=="shapeBorderWidth"){var c=propInspectorCtrl.calculateBorderLimits();if(a>c){d.val(c)}}var b=d.val();propInspectorCtrl._exportProps(e,b);updateTLWH();propInspectorCtrl.updateBackgroundBorderInfo();propInspectorCtrl.updateBorderLimits()},selectNumberValue:function(){$(this).select()},selectChanged:function(a){if($(this).val().length==0){return}var b=($(this).attr("type")=="number")?parseInt($(this).val()):$(this).val();propInspectorCtrl._exportProps(this.id,b);updateTLWH();propInspectorCtrl.updateBackgroundBorderInfo();return false},getBorderValue:function(e,g,b,c){var f=false;var d=["b","bts","bls","brs","bbs","bms"];for(type in d){if(e[d[type]]!=null){var h=(e.id==undefined)?e.segment:e.id;e[d[type]][b]=g;widget.set(e,c.attr("id"));widget._redraw(c,e)}else{var a=[0,"#333",0];widget.set({b:a},c.attr("id"));widget._redraw(c,e)}f=true}return f},resizeWidget:function(f,e,d,b){var g=b?b:storage.get(d.attr("id"));if((g)&&(g.tlwh[f.index]=="a")){g.tlwh[f.index]="100%";widget.set(g,d.attr("id"))}d.css(f.cssProperty,e);var a=[parseInt(d.css("top")),parseInt(d.css("left")),d.width(),d.height()];if(g.segment==null){widget._resize(d,null,a)}if(d.get(0).id!=d.data("lockto")){var c=d.parents(".page").get(0).id;widget._resize(d,c,false)}propInspectorCtrl.updateBorderLimits()},adjustOpacity:function(c,b,d,e){var a=propInspectorCtrl.shapeWidgets;a.each(function(){var l=$(this);var g=l.attr("id");var j=widget.get(g);if(!j.bgc){return}var m,f,h;if(l){h=l.find("canvas, img")}else{h=$("#"+g).find("canvas, img")}if(j.bgc){for(var k=0;k<j.bgc.length;k++){m=utils.hex2rgba(j.bgc[k],b);m=utils.replaceRgbaAlpha(m,b);j.bgc[k]=m}}if(j.b){f=utils.hex2rgba(j.b[1],b);f=utils.replaceRgbaAlpha(f,b);j.b[1]=f}widget.set(j,g);widget._redraw(l,j)})},getPropMap:function(a){return propInspectorCtrl[(a)+"PropMap"]},calculateBorderLimits:function(){function e(l){var o=l.tlwh[2];var k=l.tlwh[3];var m=Math.min(k,o);var n=parseInt(m/2);return n}var a=propInspectorCtrl.shapeWidgets;var f=false;var d=[];a.each(function(){var k=$(this);if(k.hasClass("ui-selected")){var m=k.attr("id");f=widget.get(m);var l=e(f);d.push(l)}});var i=$.extend(true,[],d);var h=i.sort(function(l,k){return k-l});var g=h[0];var b=d.indexOf(g);var j=a.eq(b);f=widget.get(j.attr("id"));var c=(f)?e(f):1000;return c},updateBorderLimits:function(){var c=parseInt($("#shapeBorderWidth").val());var a=parseInt($("#shapeBorderRadius").val());var d=propInspector.increaseBorderSize;var b=propInspector.increaseRadiusSize;var e=propInspectorCtrl.calculateBorderLimits();(c==e)?d.css({"pointer-events":"none","opacity":0.75}):d.css({"pointer-events":"auto","opacity":1});(a==e)?b.css({"pointer-events":"none","opacity":0.75}):b.css({"pointer-events":"auto","opacity":1})},_prevValues:{},_exportProps:function(b,d,m){var g=$(".shapeProps").is(":visible")&&"shape"||$(".textProps").is(":visible")&&"text"||undefined;var n=propInspectorCtrl.getPropMap(g)[b];var i=({"shape":propInspectorCtrl._getShapePropertyValue,"text":propInspectorCtrl._getTextPropertyValue})[g];if(n&&"command" in n&&i){var j=i;var c=$("#canvasPages .ui-selected");if(b=="shapeBorderWidth"||b=="shapeBorderRadius"){var c=$("#canvasPages .ui-selected").not(".backgroundWidget")}var a=c.map(function(){return $(this).attr("id")}).get();var e=project.getActivePageId();var l={id:a,pageId:e,propertyId:b,property:n.command.property,mode:g,from:$.map(a,function(q){var p=q+b;if(p in propInspectorCtrl._prevValues){var o=propInspectorCtrl._prevValues[p]}else{var o=i(b,n,q)||0}if(m){propInspectorCtrl._prevValues[p]=o}else{delete propInspectorCtrl._prevValues[p]}if(b=="shapeOpacitySlider"||b=="shapeOpacityArea"){o/=100}return o}),to:d};var f;for(var k=0,h=a.length;k<h;k++){f=l.from[k]!=l.to;if(f==true){break}}if(f){fluid.command.create(n.command.name,l).dispatchTo("fluid.controllers.widget",!Boolean(m))}}else{return propInspectorCtrl.exportProps(g,b,d)}},widgetSelectText:function(b){if(!b.is(".widgetText")){var a=b.find(".widgetText");if(a.size()>0){b=a}else{b=$("[data-lockto="+b.attr("id")+"] .widgetText")}}return b},exportProps:function(u,d,F,y){var c=y?$("#"+y):$("#canvasPages .ui-selected");var m=y?widget.get(y):widget.get(c.attr("id"));var k=propInspectorCtrl.getPropMap(u)[d];var h;var b;if(m.sc&&m.sc>1&&d!="shapeWidth"&&d!="shapeHeight"&&!widget.hasOwnColorProperties(m)){m.srps=true;for(var D=0;D<m.segments.length;D++){propInspectorCtrl.exportProps(u,d,F,m.segments[D].id)}}if(d.indexOf("text")>-1){var v=[];c.each(function(){var i=$(widget.getSubTextElements(this));i.each(function(){v.push($(this))})});v.push(c);for(var D=0;D<v.length;D++){var s=v[D];var a=s.attr("id");var t=widget.get(a);var E=propInspectorCtrl.widgetSelectText(s);var B;if(t.bgc&&t.ts){E.contents().wrapAll("<span></span>");var C=E.find("span").eq(0);var b=C.height();C.attr("style",E.attr("style")).css("padding",0);B={x:s.width()-C.width(),y:s.height()-C.height(),width:C.width(),height:C.height()};C.contents().eq(0).unwrap()}F=k.unit?F+k.unit:F;var w=parseInt(E.css("padding-top"));if(k.property=="top"&&F<=1){F=F.toString()+"%"}if(k.property=="font-size"){var x=E.css("font-size");var o=E.css("line-height");var g=E.css("font");var g=E.css("font-style");var f=Math.round(parseInt(o)-parseInt(x)+parseInt(F));E.css("font-size",parseInt(F)+"px");E.css("line-height",f+"px")}else{E.css(k.property,F)}widget.verticalAlign(s);t.ts=E.attr("style");widget.set({ts:E.attr("style")},a)}}else{if(d.indexOf("Opacity")>-1){var r;for(var D=0;D<c.length;D++){r=widget.get(c.eq(D).attr("id"));propInspectorCtrl.adjustOpacity(r,F,c.eq(D),c.eq(D).attr("id"))}}else{if(d.indexOf("shape")>-1){F=parseInt(F);var p=k.property;var j=k.index;var e=1;if((d=="shapeBackground"||d=="shapeBorder")&&m.bgc){e=utils.getAlphaFromColor(m.bgc[0])}if(p!=undefined&&j!=undefined){for(var D=0;D<c.length;D++){h=c.eq(D).find("canvas, img");m=widget.get(c.eq(D).attr("id"));if(!y){m=widget.get(c.eq(D).attr("id"))}if(m[p]==null&&p=="b"){var z=propInspectorCtrl.getBorderValue(m,F,j,c.eq(D))}if(typeof m[p]!=="undefined"){if(p=="tlwh"){propInspectorCtrl.resizeWidget(k,F,c.eq(D))}else{if(p=="b"&&m.segment){var l=["b","bs","bts","bls","bms","bbs","brs"];for(var q=0;q<l.length;q++){var n=m[l[q]];if(n){n[j]=F;if(j>1){n.splice(3,3)}}}}else{m[p][j]=F}widget.set(m,c.eq(D).attr("id"));var A;if(m.segments){A={mode:"all"}}else{if(m.segment){A={mode:"seg",segId:y}}}widget._redraw(c.eq(D),m,A)}}if(e!=1){propInspectorCtrl.adjustOpacity(m,e,c.eq(D),c.eq(D).attr("id"))}}}propInspectorCtrl.updateBackgroundBorderInfo()}}}}};