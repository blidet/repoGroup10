var staticWidgets={initMenus:function(){staticWidgets.fixedWidget=$("#fixedWidget");staticWidgets.unfixedWidget=$("#unfixedWidget");staticWidgets.fixedWidgetMenu=$("#fixedWidgetMenu");staticWidgets.fixedWidgetsEditor=$("#contextMenuItems .fixedWidgetsEditor");staticWidgets.pinnedBtn=$("#pinnedBtn");staticWidgets.unpinnedBtn=$("#unpinnedBtn")},changeContextMenuIndicators:function(b){var a=staticWidgets.determineStatic(b);staticWidgets.unfixedWidget.hide();staticWidgets.fixedWidget.hide();(a==false)?staticWidgets.unfixedWidget.show():staticWidgets.fixedWidget.show()},updateMenu:function(){propInspectorCtrl.saveSelection();var c=propInspectorCtrl.currentSelection.not(".backgroundWidget");staticWidgets.changeContextMenuIndicators(c);var a=staticWidgets.staticMenuOpen;staticWidgets.hideMenu();if(a==true){var b=staticWidgets.findPositionOnScreen(c);if(c.length>0&&b==true){staticWidgets.showMenu(c)}}},hideMenu:function(){staticWidgets.staticMenuOpen=false;staticWidgets.fixedWidgetsEditor.hide()},positionMenu:function(){var b=$("#staticWidgetBtn");var a=parseInt(b.css("left"));var d=parseInt(b.css("width"));var e=parseInt($("#fixedWidgMenuHolder").css("width"))+(2*(parseInt($("#fixedWidgMenuHolder").css("padding-left"))));var c=a+d-e;staticWidgets.fixedWidgetMenu.css("left",(c)).css("top",45)},showMenu:function(b){staticWidgets.staticMenuOpen=true;if(!b){propInspectorCtrl.saveSelection();b=propInspectorCtrl.currentSelection}staticWidgets.fixedWidgetsEditor.show();var a=staticWidgets.determineStatic(b);staticWidgets.updateButtonStates(a,b)},updateButtonStates:function(a,c){function b(){staticWidgets.pinnedBtn.hide().removeClass("pinBtnActivated");staticWidgets.unpinnedBtn.removeClass("pinBtnActivated singlePinnedBtn");$("#fixedWidgMenuHolder").removeClass("smallFixedWidgMenu")}b();var d=staticWidgets.findPositionOnScreen(c);if(d==true){switch(a){case (false):staticWidgets.pinnedBtn.show();staticWidgets.unpinnedBtn.addClass("pinBtnActivated");break;case ("front"):staticWidgets.pinnedBtn.show().addClass("pinBtnActivated");break;case ("back"):staticWidgets.pinnedBtn.show().addClass("pinBtnActivated");break}}else{if(a=="front"||a=="back"){staticWidgets.pinnedBtn.show().addClass("pinBtnActivated")}else{$("#fixedWidgMenuHolder").addClass("smallFixedWidgMenu");staticWidgets.unpinnedBtn.addClass("pinBtnActivated singlePinnedBtn");staticWidgets.positionMenu()}}},staticMenuOpen:false,toggleStaticWidgetMenu:function(){if(staticWidgets.staticMenuOpen==true){staticWidgets.hideMenu()}else{staticWidgets.showMenu();contextMenu.removeOtherCmMenus(["propertyInspector"])}},findPositionOnScreen:function(m,p,i){function j(q,w,s){w=$.extend(true,[],w);var u=widget.get(q);var v=20;var r=u.tlwh[2];var y=u.tlwh[3];var x=(w[0]<w[1])?"Portrait":"Landscape";var t=w[0]+v;var a=w[1]+v;if(s!==x){t=w[1]+v;a=w[0]+v}k=((u.tlwh[0]>(a-v-5))||(u.tlwh[1]>(t-v-5)))?false:true}var k=false;if(i==true){var g=$(".page").attr("id");var h=$.extend(true,{},storage.tempStorage);var n=false;for(var l in h){var b=l.match(/p_/g);if(b){var f=h[l];n=f["pageWH"]}}if(n){var e=p;var d=h[g];var c=d["orientation"];j(e,n,c)}}else{var g=project.getActivePageId();var o=widget.getRoots(m);o.each(function(){var r=$(this).attr("id");var a=project.get("pageWH");var q=page.get(g,"orientation");j(r,a,q)})}return k},hideStaticBoundary:function(){$("#verticalLimiter").remove();$("#horizontalLimiter").remove()},drawBoundaries:function(e,g,m,d,a,f,h){function l(o,v,u){function w(){o.fillStyle="rgb(255,255,255)";for(var x=0;x<s;x++){(v=="h")?o.fillRect((q/2+(q*x)),0,b,t):o.fillRect(0,(q/2+(q*x)),p,b)}}o.clearRect(0,0,p,t);var p=parseInt(u.css("width"));var t=parseInt(u.css("height"));o.fillStyle="rgb(63,169,245)";var q=b*4;var s=(v=="h")?p/q:t/q;for(var r=0;r<s;r++){(v=="h")?o.fillRect((q*r),0,b,t):o.fillRect(0,(q*r),p,b)}w()}staticWidgets.hideStaticBoundary();var c;var k;var j;var b=6;if(m>d){if(h<1){var i={width:2,height:a,top:0,left:d};$("#tmplScreenLimitV").tmpl(i).appendTo("#"+e);j=$("#verticalLimiter");c=(j[0]).getContext("2d");if(c){k="v";l(c,k,j)}}}if(g>a){if(f<1){var n={width:d,height:2,top:a,left:0};$("#tmplScreenLimitH").tmpl(n).appendTo("#"+e);j=$("#horizontalLimiter");c=(j[0]).getContext("2d");if(c){k="h";l(c,k,j)}}}},zoomInBoundary:function(){if(project.readOnly()){return}staticWidgets.hideStaticBoundary();var a=project.getActivePageId();if(a){staticWidgets.showStaticBoundary(a)}},hLimiter:false,vLimiter:false,currentPageId:false,showStaticBoundary:function(d){function m(){if(d!=staticWidgets.currentPageId){staticWidgets.hLimiter=$("#horizontalLimiter");staticWidgets.vLimiter=$("#verticalLimiter");staticWidgets.currentPageId=d}}m();var f=staticWidgets.hLimiter;var e=staticWidgets.vLimiter;var g=f.length;var i=e.length;var j=storage.get(d).width;var h=storage.get(d).height;var k=project.get("pageWH");k=$.extend(true,[],k);var b=page.get(d,"orientation");var c=k[0];var a=k[1];var l=(c<a)?"Portrait":"Landscape";if(b!==l){c=k[1];a=k[0]}staticWidgets.drawBoundaries(d,h,j,c,a,g,i)},determineStatic:function(c){allStaticWidgetsFront=[];if(c){var b=c}else{propInspectorCtrl.saveSelection();var b=propInspectorCtrl.currentSelection}b=b.not(".backgroundWidget");var d=b.length;if(d==0){a=false;return}b.each(function(){var f=$(this).attr("id");var e=widget.get(f);if(e.st=="f"){allStaticWidgetsFront.push(f)}});var a=false;if(allStaticWidgetsFront.length==d){a="front"}return a},getSelection:function(){function b(){var e=$(this);var d=e.attr("data-lockto");var c=$("#"+d);var f=widget.getLockTos($("#"+d));a=a.add(f,c)}if(!propInspectorCtrl.currentSelection){propInspectorCtrl.saveSelection()}var a=propInspectorCtrl.currentSelection.not(".backgroundWidget");a.each(b);return a},mapSelection:function(e){var f=$([]);for(var d=0;d<e.length;d++){var c=$("#"+e[d]);var b=c.attr("data-lockto");var a=$("#"+b);var g=widget.getLockTos($("#"+b));f=f.add(g,a)}return f},createZalignOrder:function(b){var a=[];b.each(function(){var c=$(this);var d=c.nextAll(".rootWidget").first().attr("id");a.push({id:c.attr("id"),fromNextId:d})});return a},pushToForeground:function(){var b=staticWidgets.getSelection();if(b.length==0||!b){return}var a=staticWidgets.determineStatic(b);if(a=="toFront"){return}fluid.command.create("staticToForeground",{direction:"toForeground",pastState:a,sel:b,order:staticWidgets.createZalignOrder(b)}).dispatchTo("fluid.controllers.widget")},removeStaticProperty:function(){var b=staticWidgets.getSelection();if(b.length==0||!b){return}var a=staticWidgets.determineStatic(b);if(a==false){return}fluid.command.create("removeStaticWidgets",{pastState:a,sel:b}).dispatchTo("fluid.controllers.widget")},zAlignWidgets:function(d,f,e){var a=widget.getRoots(d);var c=(f=="toBackground")?"cmBack":"cmFront";a.each(function(){var g=$(this);var h=g.attr("id");contextMenu.cmZAlign2(null,g,c)});if(e==false){return}var b=project.getActivePageId();page.renderBlurs(b)},alignAll:function(){var c=project.getActivePageId();var e=storage.get(c);var g=e.widgets;var j=$([]);var k=$([]);var h=false;var a;if(g){for(var d=0;d<g.length;d++){var b=g[d];var f=widget.get(b);if(f.st=="f"){a=$("#"+b);h=staticWidgets.findPositionOnScreen(a);if(h==true){j=j.add(a)}}}}var l=false;staticWidgets.zAlignWidgets(j,"toForeground",l)},create:function(c,d){var b="f";c.each(function(){var f=$(this).attr("id");var e=widget.get(f);widget.set({st:b},f)});var a=staticWidgets.determineStatic(c);staticWidgets.changeContextMenuIndicators(c);staticWidgets.updateButtonStates(a,c)},destroy:function(b){b.each(function(d){var e=$(this).attr("id");var c=widget.get(e);if(c.st=="f"){delete c["st"]}widget.set(c,e)});var a=staticWidgets.determineStatic(b);staticWidgets.changeContextMenuIndicators(b);staticWidgets.updateButtonStates(a,b)},undoZalign:function(b){for(var a=b.length-1;a>=0;a--){var f=b[a];var e=$('[data-lockto="'+f.id+'"]');if(f.fromNextId){e.detach().insertBefore("#"+f.fromNextId)}else{var d=e.parent();e.detach().appendTo(d)}}var c=project.getActivePageId();page.renderBlurs(c)},};