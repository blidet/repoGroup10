browserDetect.init();var imgCloudUrl=window.location.protocol=="http:"?"//561f5b186ef3d1bbffae-670dcfae82c728eff02629d9c4d77cbb.r43.cf2.rackcdn.com/":"//e92360842a005b2d5215-670dcfae82c728eff02629d9c4d77cbb.ssl.cf2.rackcdn.com/";var loading_Stage_Check="Not Loaded";if(!window.pagesCache){window.pagesCache={}}if(!window.widgetsCache){window.widgetsCache={}}$(document).ready(function(f){var d=$.event.props,a=d.length,b=[];while(a--){var c=d[a];if(c!="layerX"&&c!="layerY"){b.push(c)}}$.event.props=b;document.onselectstart=function(){return false}});if(browserDetect.browser=="Explorer"||/Trident/.test(navigator.userAgent)||browserDetect.browser=="Opera"){$(document).ready(function(a){$("body").empty().append($("#tmplInvalid").tmpl());return})}else{if(window.g_print==true&&window.g_preview!=undefined){$(document).ready(function(a){preview.load(g_preview);setTimeout(window.print,1000);return false})}else{if(window.g_preview!=undefined){var homePageStyle=document.createElement("style");homePageStyle.id="homePageStyle";homePageStyle.type="text/css";homePageStyle.innerHTML="#homePage { background-image: none; }";document.head.appendChild(homePageStyle);preview.load(window.g_preview,preview.afterPreviewLoad)}else{dbStorage.init();lib.loadWdgDefinitions();if(dbStorage.dbAvailable){dbStorage.onReady(function(){dbStorage.get("uiIcons","svgIcons",function(a){if(a.failed.length){fetchSvgIcons()}else{document.head.insertAdjacentHTML("beforeend",a.resultsObj.svgIcons.data)}})})}else{fetchSvgIcons()}if(!window.pagesCache){window.pagesCache={}}if(window!==window.top){window.parent.location=window.location.href}function editorInit(g){account.setLoadingStep(0);var b="last";widget.useCanvas=((browserDetect.browser=="Safari")||(navigator.userAgent.match(/Android/i)))?true:false;if(account.isBrandNewUser()==true){account.setup();account.createUser();b=project.add(g,"Project 1")}if((g_pid!="")&&(g_imgFullCanvas=="true")){b=g_pid}account.checkIntegrity();var a=account.get("id");var f=storage.get(a);var h="NewUser";if(f.accType=="New"||f.accType==null){account.drawSignup()}else{account.draw(f);h="LoggedInUser"}function c(){notification.init();upload.init();userActionsInit2();project.load();userActionsInit();propInspector.init();staticWidgets.initMenus();screensize.width=$(window).width();screensize.height=$(window).height();tracker.record("loadEditor"+h,1);loading_Stage_Check="Editor Loaded";checkUserSession();watchUserSession(true);account.validateState();function e(){switch(window.location.hash){case"#signin":if(account.get("loggedIn")==="no"){fluidMenu.show()}break;case"#upgrade":if(account.get("loggedIn")==="yes"){userSettings.goToUpgrade()}break;default:var j=/^#buy(?:-([\w-]+))?$/.exec(window.location.hash);if(j&&j.length>0){if(account.get("loggedIn")!="yes"){userSettings.goToCreateAccount(null,j[1])}else{userSettings.goToUpgrade(null,j[1])}}else{j=/^#offer(?:-(\w+))?$/.exec(window.location.hash);if(j&&j.length>0){userSettings.goToUpgrade(null,null,(j[1]||"").toUpperCase())}}break}history.pushState("",document.title,window.location.pathname)}e();window.onhashchange=e;function i(){fluid.command.create("open",{id:b,onLoad:function(){fluid.controllers.bin.init()}}).dispatchTo("fluid.controllers.project");showPostLoadMessage();account.setLoadingStep(5);$("#font-preloader").remove();fluid.main.fire("editor.loaded")}if(lib.ready){i()}else{fluid.main.on("libready",i)}}function d(){fullCanvas.init(b);$("#font-preloader").remove()}if(g_imgFullCanvas=="true"){$(window).load(d)}else{$(window).load(c)}}if(localStorage){var restoreId=localStorage.getItem("refreshing");if(restoreId){localStorage.removeItem("refreshing");g_instanceId=parseInt(restoreId)}else{g_instanceId=parseInt(Math.random()*100000000)}localStorage.setItem("instanceId",g_instanceId);localStorage.removeItem("storageCleared")}$(document).ready(editorInit)}}};